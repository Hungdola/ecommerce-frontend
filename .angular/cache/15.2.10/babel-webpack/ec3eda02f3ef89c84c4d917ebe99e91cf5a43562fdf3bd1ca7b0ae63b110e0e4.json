{"ast":null,"code":"import { HttpHeaders } from \"@angular/common/http\";\nimport { catchError, map, of } from \"rxjs\";\nimport { BASE_API_URL } from \"src/app/config/api\";\nimport { getUserProfileFailure, getUserProfileSuccess, logoutSuccess } from \"./user.action\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@ngrx/store\";\nexport class UserService {\n  constructor(http, store) {\n    this.http = http;\n    this.store = store;\n    this.apiUrl = BASE_API_URL + \"/api/users\";\n    this.headers = new HttpHeaders().set(\"Authorization\", `Bearer ${localStorage.getItem(\"jwt\")}`);\n  }\n  getUserProfile() {\n    const headers = new HttpHeaders().set(\"Authorization\", `Bearer ${localStorage.getItem(\"jwt\")}`);\n    return this.http.get(`${this.apiUrl}/profile`, {\n      headers\n    }).pipe(map(user => {\n      console.log('user profile success ', user);\n      return getUserProfileSuccess({\n        userProfile: user\n      });\n    }), catchError(error => {\n      return of(getUserProfileFailure(error.response && error.response.data.message ? error.response.data.message : error.message));\n    })).subscribe(action => this.store.dispatch(action));\n  }\n  logout() {\n    localStorage.removeItem(\"jwt\");\n    this.store.dispatch(logoutSuccess());\n  }\n  static #_ = this.ɵfac = function UserService_Factory(t) {\n    return new (t || UserService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.Store));\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: UserService,\n    factory: UserService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"mappings":"AAAA,SAAqBA,WAAW,QAAQ,sBAAsB;AAG9D,SAASC,UAAU,EAAEC,GAAG,EAAEC,EAAE,QAAQ,MAAM;AAC1C,SAASC,YAAY,QAAQ,oBAAoB;AACjD,SAASC,qBAAqB,EAAEC,qBAAqB,EAAEC,aAAa,QAAQ,eAAe;;;;AAO3F,OAAM,MAAOC,WAAW;EAKpBC,YAAqBC,IAAgB,EAAUC,KAAY;IAAtC,SAAI,GAAJD,IAAI;IAAsB,UAAK,GAALC,KAAK;IAH5C,WAAM,GAAGP,YAAY,GAAC,YAAY;IAKtC,IAAI,CAACQ,OAAO,GAAE,IAAIZ,WAAW,EAAE,CAACa,GAAG,CAAC,eAAe,EAAE,UAAUC,YAAY,CAACC,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC;EACjG;EAGAC,cAAc;IAEV,MAAMJ,OAAO,GAAE,IAAIZ,WAAW,EAAE,CAACa,GAAG,CAAC,eAAe,EAAE,UAAUC,YAAY,CAACC,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC;IAE9F,OAAO,IAAI,CAACL,IAAI,CAACO,GAAG,CAAC,GAAG,IAAI,CAACC,MAAM,UAAU,EAAE;MAACN;IAAO,CAAC,CAAC,CAACO,IAAI,CAC1DjB,GAAG,CAAEkB,IAAS,IAAI;MACdC,OAAO,CAACC,GAAG,CAAC,uBAAuB,EAAEF,IAAI,CAAC;MAE1C,OAAOd,qBAAqB,CAAC;QAACiB,WAAW,EAAEH;MAAI,CAAC,CAAC;IACrD,CAAC,CAAC,EACFnB,UAAU,CAAEuB,KAAK,IAAI;MACjB,OAAOrB,EAAE,CACLE,qBAAqB,CACjBmB,KAAK,CAACC,QAAQ,IAAID,KAAK,CAACC,QAAQ,CAACC,IAAI,CAACC,OAAO,GAAGH,KAAK,CAACC,QAAQ,CAACC,IAAI,CAACC,OAAO,GAAEH,KAAK,CAACG,OAAO,CAC7F,CACJ;IACL,CAAC,CAAC,CACL,CAACC,SAAS,CAAEC,MAAM,IAAK,IAAI,CAAClB,KAAK,CAACmB,QAAQ,CAACD,MAAM,CAAC,CAAC;EACxD;EAEAE,MAAM;IACFjB,YAAY,CAACkB,UAAU,CAAC,KAAK,CAAC;IAC9B,IAAI,CAACrB,KAAK,CAACmB,QAAQ,CAACvB,aAAa,EAAE,CAAC;EACxC;EAAC;qBAlCQC,WAAW;EAAA;EAAA;WAAXA,WAAW;IAAAyB,SAAXzB,WAAW;IAAA0B,YAJR;EAAM","names":["HttpHeaders","catchError","map","of","BASE_API_URL","getUserProfileFailure","getUserProfileSuccess","logoutSuccess","UserService","constructor","http","store","headers","set","localStorage","getItem","getUserProfile","get","apiUrl","pipe","user","console","log","userProfile","error","response","data","message","subscribe","action","dispatch","logout","removeItem","factory","providedIn"],"sourceRoot":"","sources":["D:\\project-angular-sale-website\\ecommerce-angular\\src\\app\\State\\User\\user.service.ts"],"sourcesContent":["import { HttpClient, HttpHeaders } from \"@angular/common/http\";\r\nimport { Injectable } from \"@angular/core\";\r\nimport { Store } from \"@ngrx/store\";\r\nimport { catchError, map, of } from \"rxjs\";\r\nimport { BASE_API_URL } from \"src/app/config/api\";\r\nimport { getUserProfileFailure, getUserProfileSuccess, logoutSuccess } from \"./user.action\";\r\n\r\n@Injectable({\r\n    providedIn: 'root',\r\n\r\n})\r\n\r\nexport class UserService {\r\n\r\n    private apiUrl = BASE_API_URL+\"/api/users\"\r\n    headers: any\r\n\r\n    constructor( private http: HttpClient, private store: Store) {\r\n\r\n        this.headers= new HttpHeaders().set(\"Authorization\", `Bearer ${localStorage.getItem(\"jwt\")}`)\r\n    }\r\n\r\n\r\n    getUserProfile() {\r\n\r\n        const headers= new HttpHeaders().set(\"Authorization\", `Bearer ${localStorage.getItem(\"jwt\")}`)\r\n\r\n        return this.http.get(`${this.apiUrl}/profile`, {headers}).pipe(\r\n            map((user: any) => {\r\n                console.log('user profile success ', user)\r\n\r\n                return getUserProfileSuccess({userProfile: user})\r\n            }),\r\n            catchError((error) => {\r\n                return of(\r\n                    getUserProfileFailure(\r\n                        error.response && error.response.data.message ? error.response.data.message: error.message\r\n                    )\r\n                )\r\n            })\r\n        ).subscribe((action) => this.store.dispatch(action))\r\n    }\r\n\r\n    logout() {\r\n        localStorage.removeItem(\"jwt\")\r\n        this.store.dispatch(logoutSuccess())\r\n    }\r\n}"]},"metadata":{},"sourceType":"module","externalDependencies":[]}